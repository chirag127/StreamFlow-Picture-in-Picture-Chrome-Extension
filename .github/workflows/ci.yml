name: CI

# Controls when the action will run.
# For various triggers, see the workflow customization guide at https://docs.github.com/en/actions/using-workflows/on
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # Build job
  build:
    name: Build and Test
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      # Checks-out your repository into the way you can access it.
      - name: Checkout repository
        uses: actions/checkout@v4

      # Setup Node.js environment for JavaScript extensions
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # Use a recent LTS version
          cache: 'npm' # Cache npm dependencies

      # Install dependencies
      - name: Install dependencies
        run: npm install

      # Run linters and formatters (assuming a setup with ESLint/Prettier or similar for JS)
      # For Chrome Extensions, often simple linting is sufficient for CI
      - name: Lint code
        run: npm run lint # Assuming a 'lint' script exists in package.json

      # Build the extension
      - name: Build extension
        run: npm run build # Assuming a 'build' script exists in package.json that packages the extension

      # Upload build artifacts for later inspection or deployment
      - name: Upload build artifact
        uses: actions/upload-artifact@v4
        with:
          name: dist # Name of the artifact
          path: dist/ # Path to the directory containing built extension files

  # Test job (optional but recommended for complex extensions)
  # For a simple Chrome Extension, extensive E2E testing might be overkill or require browser-specific runners.
  # This placeholder demonstrates where testing would go.
  # test:
  #   name: Run Tests
  #   runs-on: ubuntu-latest
  #   needs: build # Ensure build is completed first
  #   steps:
  #     - name: Checkout repository
  #       uses: actions/checkout@v4
  #     - name: Setup Node.js
  #       uses: actions/setup-node@v4
  #       with:
  #         node-version: '20'
  #         cache: 'npm'
  #     - name: Install dependencies
  #       run: npm install
  #     - name: Run Unit/Integration Tests
  #       run: npm test # Assuming a 'test' script exists in package.json
